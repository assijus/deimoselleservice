package com.crivano.demoiselle.rest.server;

import org.json.JSONException;

import com.crivano.blucservice.api.IBlueCrystal;
import com.crivano.blucservice.api.IBlueCrystal.CertDetails;
import com.crivano.blucservice.api.IBlueCrystal.CertificatePostRequest;
import com.crivano.blucservice.api.IBlueCrystal.CertificatePostResponse;
import com.crivano.blucservice.api.IBlueCrystal.EnvelopePostRequest;
import com.crivano.blucservice.api.IBlueCrystal.EnvelopePostResponse;
import com.crivano.blucservice.api.IBlueCrystal.HashPostRequest;
import com.crivano.blucservice.api.IBlueCrystal.HashPostResponse;
import com.crivano.blucservice.api.IBlueCrystal.ValidatePostRequest;
import com.crivano.blucservice.api.IBlueCrystal.ValidatePostResponse;
import com.crivano.swaggerservlet.SwaggerTestSupport;
import com.crivano.swaggerservlet.SwaggerUtils;

public class DemoiselleServiceTest extends SwaggerTestSupport {

	String fileADRB23 = "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u78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNC4yLjEtYzA0MyA1Mi4zNzI3MjgsIDIwMDkvMDEvMTgtMTU6MDg6MDQgICAgICAgICI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyI+CiAgICAgICAgIDxkYzpmb3JtYXQ+YXBwbGljYXRpb24vcGRmPC9kYzpmb3JtYXQ+CiAgICAgICAgIDxkYzpjcmVhdG9yPgogICAgICAgICAgICA8cmRmOlNlcT4KICAgICAgICAgICAgICAgPHJkZjpsaT5jZGFpbHk8L3JkZjpsaT4KICAgICAgICAgICAgPC9yZGY6U2VxPgogICAgICAgICA8L2RjOmNyZWF0b3I+CiAgICAgICAgIDxkYzp0aXRsZT4KICAgICAgICAgICAgPHJkZjpBbHQ+CiAgICAgICAgICAgICAgIDxyZGY6bGkgeG1sOmxhbmc9IngtZGVmYXVsdCI+VGhpcyBpcyBhIHRlc3QgUERGIGZpbGU8L3JkZjpsaT4KICAgICAgICAgICAgPC9yZGY6QWx0PgogICAgICAgICA8L2RjOnRpdGxlPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj4KICAgICAgICAgPHhtcDpDcmVhdGVEYXRlPjIwMDAtMDYtMjlUMTA6MjE6MDgrMTE6MDA8L3htcDpDcmVhdGVEYXRlPgogICAgICAgICA8eG1wOkNyZWF0b3JUb29sPk1pY3Jvc29mdCBXb3JkIDguMDwveG1wOkNyZWF0b3JUb29sPgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAxMy0xMC0yOFQxNToyNDoxMy0wNDowMDwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXA6TWV0YWRhdGFEYXRlPjIwMTMtMTAtMjhUMTU6MjQ6MTMtMDQ6MDA8L3htcDpNZXRhZGF0YURhdGU+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczpwZGY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGRmLzEuMy8iPgogICAgICAgICA8cGRmOlByb2R1Y2VyPkFjcm9iYXQgRGlzdGlsbGVyIDQuMCBmb3IgV2luZG93czwvcGRmOlByb2R1Y2VyPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iPgogICAgICAgICA8eG1wTU06RG9jdW1lbnRJRD51dWlkOjA4MDVlMjIxLTgwYTgtNDU5ZS1hNTIyLTYzNWVkNWMxZTJlNjwveG1wTU06RG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkluc3RhbmNlSUQ+dXVpZDo2MmQ2YWU2ZC00M2M0LTQ3MmQtOWIyOC03YzRhZGQ4ZjllNDY8L3htcE1NOkluc3RhbmNlSUQ+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz4NCmVuZHN0cmVhbQ1lbmRvYmoNMiAwIG9iag08PC9GaWx0ZXIvRmxhdGVEZWNvZGUvRmlyc3QgNC9MZW5ndGggNDgvTiAxL1R5cGUvT2JqU3RtPj5zdHJlYW0NCmjeMlUwULCx0XfOL80rUTDU985MKY62BIoFxeqHVBak6gckpqcW29kBBBgA1ncLgA0KZW5kc3RyZWFtDWVuZG9iag0zIDAgb2JqDTw8L0ZpbHRlci9GbGF0ZURlY29kZS9GaXJzdCA0L0xlbmd0aCAxNjcvTiAxL1R5cGUvT2JqU3RtPj5zdHJlYW0NCmjePMvBCsIwEEXRX5mdDaKdxCpVSqFY3AkuBNexSelA6EAyRfx7A4qPu3znAAhNU3aLTByLwVkKb1Weo7dCPPdWfNGfDOYdzFGj0VivtV4hrn6vrK40RE48Cjw4Oqi3qMoruz/WuwxrvTeV3m2w+uJbZLcMPhZdxk8r0FMSCsFHqLYII0d40Oz4lVR5Jwm+uE+UIGdBfBK49RcYKXjVth8BBgBnZztkDQplbmRzdHJlYW0NZW5kb2JqDTQgMCBvYmoNPDwvRGVjb2RlUGFybXM8PC9Db2x1bW5zIDMvUHJlZGljdG9yIDEyPj4vRmlsdGVyL0ZsYXRlRGVjb2RlL0lEWzw0REM5MUExODc1QTZENzA3QUVDMjAzQkIwMjFDOTNBMD48RjZDOTJCMzY4QThBMTM0MDg0NTdBMUQzOTVBMzdFQjk+XS9JbmZvIDYgMCBSL0xlbmd0aCAzNy9Sb290IDggMCBSL1NpemUgNy9UeXBlL1hSZWYvV1sxIDIgMF0+PnN0cmVhbQ0KaN5iYmBgYGLkPcLEwD+ViYGhh4mBkYWJ8bEkkM0IEGAAKlkDFA0KZW5kc3RyZWFtDWVuZG9iag1zdGFydHhyZWYNCjExNg0KJSVFT0YNCg==";
	String certificateADRB23 = "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";
	String timeADRB23 = "2022-03-29T14:50:25.453-03:00";
	String sha1ADRB23 = "/IDVmHe0riGRFZG1NmSy2hMkzyU=";
	String sha256ADRB23 = "YL3RPqSCe43jdcedw/+Ef4O1W9c7ZGFSP9+PhDtaDVs=";
	String hashADRB23 = "MYIBqTAYBgkqhkiG9w0BCQMxCwYJKoZIhvcNAQcBMBwGCSqGSIb3DQEJBTEPFw0yMjAzMjkxNzUwMjVaMC8GCSqGSIb3DQEJBDEiBCBgvdE+pIJ7jeN1x53D/4R/g7Vb1ztkYVI/34+EO1oNWzCBlAYLKoZIhvcNAQkQAg8xgYQwgYEGCGBMAQcBAQIDMC8wCwYJYIZIAWUDBAIBBCCxboi793MipnmVt5B4d47T0Op8iFh7b21Ri3Fej3aj1TBEMEIGCyqGSIb3DQEJEAUBFjNodHRwOi8vcG9saXRpY2FzLmljcGJyYXNpbC5nb3YuYnIvUEFfQURfUkJfdjJfMy5kZXIwgaYGCyqGSIb3DQEJEAIvMYGWMIGTMIGQMIGNBCCeoeW8mQGEzRKWG7WaCujdXsd4rMJwz0XdWy91u1/FaDBpMF2kWzBZMQswCQYDVQQGEwJCUjETMBEGA1UEChMKSUNQLUJyYXNpbDEVMBMGA1UECxMMQUMgU09MVVRJIHY1MR4wHAYDVQQDExVBQyBTT0xVVEkgTXVsdGlwbGEgdjUCCBHeIQYHUaYc";
	String signatureADRB23 = "g7vnjduIA0ON3R2cSp1vStHzUfhbOZ50OyRR3Hfh7t38Q40qFwzs8cRbf4z9AVlQlqCepw0rlhMv0EG/dnpSuCoOQlCfcUET72uAdlfj5oUNHKJavq0uTbRv6cVEXp1h/SSeFNwcaT+ImbTIwP/Q/lMhm1/buTNwPaFnxvNWrXL7+ykzVl9yGM+Q6xImhLrDlWjuDaG58Ar/iNNJ9er1QJdMfo4i6gWmG4cVOIqSB1Uuy4eKCdtjX1rpem6yy5PKuhZ0g182DaBSIjIaMd3vbLwChTjGR0d5zTWE0M2vLY9vf4UwJr9w/f32wvD9CbLRLyy7Szstsx9koBoScZCguA==";
	String envelopeADRB23 = "MIAGCSqGSIb3DQEHAqCAMIACAQExDzANBglghkgBZQMEAgEFADCABgkqhkiG9w0BBwEAAKCAMIIHEDCCBPigAwIBAgIIEd4hBgdRphwwDQYJKoZIhvcNAQELBQAwWTELMAkGA1UEBhMCQlIxEzARBgNVBAoTCklDUC1CcmFzaWwxFTATBgNVBAsTDEFDIFNPTFVUSSB2NTEeMBwGA1UEAxMVQUMgU09MVVRJIE11bHRpcGxhIHY1MB4XDTIxMDYwODE5MjAwMFoXDTIyMDYwODE5MjAwMFowgckxCzAJBgNVBAYTAkJSMRMwEQYDVQQKEwpJQ1AtQnJhc2lsMR4wHAYDVQQLExVBQyBTT0xVVEkgTXVsdGlwbGEgdjUxFzAVBgNVBAsTDjA5NDYxNjQ3MDAwMTk1MRkwFwYDVQQLExBWaWRlb2NvbmZlcmVuY2lhMRowGAYDVQQLExFDZXJ0aWZpY2FkbyBQRiBBMTE1MDMGA1UEAxMsUkVOQVRPIERPIEFNQVJBTCBDUklWQU5PIE1BQ0hBRE86MDA0ODk2MjM3NjAwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCuDr8uI5txKEkLw2PmsV+VcbPMUXH7n5bu1gmhSB3cdvCDunMKaB4u9vS+ihQ/89eRskq1ovW5vyf/SXJxckXofPh1CPNt1oAGtz4veL4oWdO+GDvW3rBgO8aC3/wn3jn7zozqS7s0zBtzP1ozPheq+EZb+DIsM85zFLRvHRneiVf89qmU0Cl6Cvx7xFSTDBkXiIsJX1AaVbkivaed3gS8vzPfigjnhEKZxgbTiQbxnKPGRGG6hst7dj+PAP1KSSXi6MT/VdAi/2sHhN74l2doWUnnp8o+vOvqJUKjGYkOYRsqpv2v6/Fs8lwcVskGfpH495ydxCuOysOKG+dKVfq/AgMBAAGjggJpMIICZTAJBgNVHRMEAjAAMB8GA1UdIwQYMBaAFMVS7SWACd+cgsifR8bdtF8x3bmxMFQGCCsGAQUFBwEBBEgwRjBEBggrBgEFBQcwAoY4aHR0cDovL2NjZC5hY3NvbHV0aS5jb20uYnIvbGNyL2FjLXNvbHV0aS1tdWx0aXBsYS12NS5wN2IwgZgGA1UdEQSBkDCBjYEYcmVuYXRvLmNyaXZhbm9AZ21haWwuY29toDgGBWBMAQMBoC8TLTE2MTIxOTY4MDA0ODk2MjM3NjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMKAXBgVgTAEDBqAOEwwwMDAwMDAwMDAwMDCgHgYFYEwBAwWgFRMTMDAwMDAwMDAwMDAwMDAwMDAwMDBdBgNVHSAEVjBUMFIGBmBMAQIBJjBIMEYGCCsGAQUFBwIBFjpodHRwOi8vY2NkLmFjc29sdXRpLmNvbS5ici9kb2NzL2RwYy1hYy1zb2x1dGktbXVsdGlwbGEucGRmMCkGA1UdJQQiMCAGCCsGAQUFBwMCBggrBgEFBQcDBAYKKwYBBAGCNxQCAjCBjAYDVR0fBIGEMIGBMD6gPKA6hjhodHRwOi8vY2NkLmFjc29sdXRpLmNvbS5ici9sY3IvYWMtc29sdXRpLW11bHRpcGxhLXY1LmNybDA/oD2gO4Y5aHR0cDovL2NjZDIuYWNzb2x1dGkuY29tLmJyL2xjci9hYy1zb2x1dGktbXVsdGlwbGEtdjUuY3JsMB0GA1UdDgQWBBQwN3x2t5vdauA2ArjCQ2J7WCmLNjAOBgNVHQ8BAf8EBAMCBeAwDQYJKoZIhvcNAQELBQADggIBAHgI41I6GfarKvnUJx/NcKBZh3KPoe/U/4/Tf7BUGQ0on3FPOFerDlzn6sCnO6ZLUJCFFOpTSFV92+ct839SyKNvS+JDBsUV2MthA6YPksfsuvL86+TgJRUY1zF82JfrFXXrCkg+S3//DtK5n6S6NdPuVq/bw2LibU6HCpcF+6xAdig1Pa7+DQ4TrX7/IXyZ3mHtsa2KoL1er3iIszzvmOtaRp1iSkROYHRgO6cXayHKS12BxVUZxqhr0xpbqo2z7tIZR5/OpLR2Em7uOejGbwPcRhiHSPwgFLJahPLTfvbRdTvHvJdxTKiI4rm5zqoCLWQikaCfJ2aVlU0VEb7JZb8nSVjdm2oj2o9CvUx1pHULzT0msLKJCOuNj4Y9hk1W8Gd3Tq50wgS0z242WBJaXkpwHTDgVvsM5iXeNDf+pHFcx9vVLNMcS0N5fmyX30Q6FSzeg402XbHCa++qi8VAsZyEJlYlqd/c27W0e8rY/2GgfIXktvx1p4W9oq1Q4J/HkNj+xTQMeyPsB06+pCGKNGwX4/8suhM6vYKOZ3FaUlACh1AGwsxZeg9OGPcgIKrFgfu0+6bWSOBcGO88DxGh0YERdGTubVVOf5lMIoqRoXvTI1cd8JPOo1Yf61Jf9sYUFycw+QMIXSu/mk4izRdkKWOgyxDO0lhHx9zsfBJqSAb0AAAxggM5MIIDNQIBATBlMFkxCzAJBgNVBAYTAkJSMRMwEQYDVQQKEwpJQ1AtQnJhc2lsMRUwEwYDVQQLEwxBQyBTT0xVVEkgdjUxHjAcBgNVBAMTFUFDIFNPTFVUSSBNdWx0aXBsYSB2NQIIEd4hBgdRphwwCwYJYIZIAWUDBAIBoIIBqTAYBgkqhkiG9w0BCQMxCwYJKoZIhvcNAQcBMBwGCSqGSIb3DQEJBTEPFw0yMjAzMjkxNzUwMjVaMC8GCSqGSIb3DQEJBDEiBCBgvdE+pIJ7jeN1x53D/4R/g7Vb1ztkYVI/34+EO1oNWzCBlAYLKoZIhvcNAQkQAg8xgYQwgYEGCGBMAQcBAQIDMC8wCwYJYIZIAWUDBAIBBCCxboi793MipnmVt5B4d47T0Op8iFh7b21Ri3Fej3aj1TBEMEIGCyqGSIb3DQEJEAUBFjNodHRwOi8vcG9saXRpY2FzLmljcGJyYXNpbC5nb3YuYnIvUEFfQURfUkJfdjJfMy5kZXIwgaYGCyqGSIb3DQEJEAIvMYGWMIGTMIGQMIGNBCCeoeW8mQGEzRKWG7WaCujdXsd4rMJwz0XdWy91u1/FaDBpMF2kWzBZMQswCQYDVQQGEwJCUjETMBEGA1UEChMKSUNQLUJyYXNpbDEVMBMGA1UECxMMQUMgU09MVVRJIHY1MR4wHAYDVQQDExVBQyBTT0xVVEkgTXVsdGlwbGEgdjUCCBHeIQYHUaYcMAsGCSqGSIb3DQEBCwSCAQCDu+eN24gDQ43dHZxKnW9K0fNR+Fs5nnQ7JFHcd+Hu3fxDjSoXDOzxxFt/jP0BWVCWoJ6nDSuWEy/QQb92elK4Kg5CUJ9xQRPva4B2V+PmhQ0colq+rS5NtG/pxURenWH9JJ4U3BxpP4iZtMjA/9D+UyGbX9u5M3A9oWfG81atcvv7KTNWX3IYz5DrEiaEusOVaO4NobnwCv+I00n16vVAl0x+jiLqBaYbhxU4ipIHVS7Lh4oJ22NfWul6brLLk8q6FnSDXzYNoFIiMhox3e9svAKFOMZHR3nNNYTQza8tj29/hTAmv3D9/fbC8P0JstEvLLtLOy2zH2SgGhJxkKC4AAAAAAAA";

	@Override
	protected String getPackage() {
		return "com.crivano.demoiselle.rest.server";
	}

	@Override
	protected Class getAPI() {
		return IBlueCrystal.class;
	}

	public void testCertificate_Simple_Success() throws JSONException {
		CertificatePostRequest req = new CertificatePostRequest();
		CertificatePostResponse resp = new CertificatePostResponse();

		req.certificate = SwaggerUtils.base64Decode(certificateADRB23);
		run("POST", "/certificate", req, resp);

		assertEquals("RENATO DO AMARAL CRIVANO MACHADO:00489623760", resp.cn);
		assertEquals(
				"CN=RENATO DO AMARAL CRIVANO MACHADO:00489623760, OU=Certificado PF A1, OU=Videoconferencia, OU=09461647000195, OU=AC SOLUTI Multipla v5, O=ICP-Brasil, C=BR",
				resp.subject);
		assertEquals("RENATO DO AMARAL CRIVANO MACHADO", resp.name);
		assertEquals("00489623760", resp.cpf);
		assertEquals(resp.certdetails.cpf0, resp.cpf);
	}

	public void testCertificateADRB23_Simple_Success() throws JSONException {
		CertificatePostRequest req = new CertificatePostRequest();
		CertificatePostResponse resp = new CertificatePostResponse();

		req.certificate = SwaggerUtils.base64Decode(certificateADRB23);
		run("POST", "/certificate", req, resp);

		assertEquals("RENATO DO AMARAL CRIVANO MACHADO:00489623760", resp.cn);
		assertEquals(
				"CN=RENATO DO AMARAL CRIVANO MACHADO:00489623760, OU=Certificado PF A1, OU=Videoconferencia, OU=09461647000195, OU=AC SOLUTI Multipla v5, O=ICP-Brasil, C=BR",
				resp.subject);
		assertEquals("RENATO DO AMARAL CRIVANO MACHADO", resp.name);
		assertEquals("00489623760", resp.cpf);
		assertEquals(resp.certdetails.cpf0, resp.cpf);
	}

	public void testHash_ADRB23_Success() throws JSONException {
		HashPostRequest req = new HashPostRequest();
		HashPostResponse resp = new HashPostResponse();

		req.certificate = SwaggerUtils.base64Decode(certificateADRB23);
		req.policy = "AD-RB";
		req.sha1 = SwaggerUtils.base64Decode(sha1ADRB23);
		req.sha256 = SwaggerUtils.base64Decode(sha256ADRB23);
		req.time = javax.xml.bind.DatatypeConverter.parseDateTime(timeADRB23).getTime();
		req.crl = false;
		run("POST", "/hash", req, resp);

		assertEquals(hashADRB23, SwaggerUtils.base64Encode(resp.hash));
		assertEquals("RENATO DO AMARAL CRIVANO MACHADO:00489623760", resp.cn);
		assertEquals("AD-RB", resp.policy);
		assertEquals("2.16.76.1.7.1.1.2.3", resp.policyoid);
		assertEquals("2.3", resp.policyversion);
		assertTrue(resp.certdetails instanceof CertDetails);
		// assertTrue(resp.error == null);
	}

	public void testEnvelope_ADRB23_Success() throws JSONException {
		EnvelopePostRequest req = new EnvelopePostRequest();
		EnvelopePostResponse resp = new EnvelopePostResponse();

		req.certificate = SwaggerUtils.base64Decode(certificateADRB23);
		req.policy = "AD-RB";
		req.signature = SwaggerUtils.base64Decode(signatureADRB23);
		req.sha1 = SwaggerUtils.base64Decode(sha1ADRB23);
		req.sha256 = SwaggerUtils.base64Decode(sha256ADRB23);
		req.time = javax.xml.bind.DatatypeConverter.parseDateTime(timeADRB23).getTime();
		req.crl = false;

		run("POST", "/envelope", req, resp);

		assertEquals(envelopeADRB23, SwaggerUtils.base64Encode(resp.envelope));
		assertEquals("RENATO DO AMARAL CRIVANO MACHADO:00489623760", resp.cn);
		assertEquals("AD-RB", resp.policy);
		assertEquals("2.16.76.1.7.1.1.2.3", resp.policyoid);
		assertEquals("2.3", resp.policyversion);
		assertTrue(resp.certdetails instanceof CertDetails);
	}

	public void testValidate_ADRB23_Success() throws JSONException {
		ValidatePostRequest req = new ValidatePostRequest();
		ValidatePostResponse resp = new ValidatePostResponse();

		setProperty("threadpool.size", "20");

		req.envelope = SwaggerUtils.base64Decode(envelopeADRB23);
		req.sha1 = SwaggerUtils.base64Decode(sha1ADRB23);
		req.sha256 = SwaggerUtils.base64Decode(sha256ADRB23);
		req.time = javax.xml.bind.DatatypeConverter.parseDateTime(timeADRB23).getTime();
		req.crl = false;
		run("POST", "/validate", req, resp);

		// TODO: trocar por "name"
		assertEquals("RENATO DO AMARAL CRIVANO MACHADO", resp.cn);
		assertEquals("AD-RB", resp.policy);
		assertEquals("2.16.76.1.7.1.1.2.3", resp.policyoid);
		assertEquals("2.3", resp.policyversion);
		assertTrue(resp.certdetails instanceof CertDetails);
		assertTrue(resp.errormsg == null);
	}

}
